<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>MCI Kids - Minist√©rio Infantil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primaria:#4B1E6D; --secundaria:#FF9800; --azul:#4FC3F7; --verde:#8BC34A;
      --fundo:#FFF8E1; --card:#FCE4EC; --texto:#333; --borda:#ddd;
    }
    *{box-sizing:border-box}
    body {
      font-family:'Comic Neue',cursive;
      margin:0;
      color:var(--texto);
      font-size:17px;
      background: linear-gradient(135deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 1400% 1400%;
      animation: rainbow 20s ease infinite;
    }
    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header{background:var(--primaria);color:#fff;padding:16px;text-align:center}
    header img{height:90px}
    main{max-width:1000px;margin:0 auto;padding:16px}
    .versiculo{font-style:italic;color:#000;text-align:center;margin:12px 0 20px}
    .menu-grid{display:grid;gap:12px;grid-template-columns:1fr;margin-top:12px}
    @media(min-width:640px){.menu-grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:900px){.menu-grid{grid-template-columns:repeat(4,1fr)}}
    .btn{background:var(--secundaria);color:#fff;border:none;padding:12px 16px;border-radius:8px;cursor:pointer;font-size:16px}
    .btn:hover{background:#F57C00}
    .btn-sec{background:var(--azul)}
    .card{background:var(--card);border-radius:12px;padding:16px;margin-top:16px;border:1px solid var(--borda)}
    .hidden{display:none!important}
    input,select,textarea{width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:8px;font-size:16px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #bbb;padding:8px;text-align:center;font-size:15px}
    th{background:#f5f5f5}
    .pill{display:inline-block;padding:4px 8px;border-radius:999px;background:#eee;font-size:12px}
    .subtle{color:#666;font-size:13px}
    .center{text-align:center}
    .mt-8{margin-top:8px} .mt-12{margin-top:12px} .mt-16{margin-top:16px}
    .flex{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label strong{margin-right:8px}
  </style>
</head>
<body>
<header>
  <img src="logo.png" alt="Logo MCI Kids">
  <h1>Minist√©rio Infantil - MCI Kids</h1>
</header>

<main>
  <p class="versiculo">"Ensina a crian√ßa no caminho em que deve andar..." - Prov√©rbios 22:6</p>
  <div class="center"><button class="btn" onclick="mostrarMenu()">Entrar</button></div>

  <!-- Menu principal -->
  <div id="menuPrincipal" class="menu-grid hidden">
    <button class="btn" onclick="abrirArea('pais')">üë®‚Äçüë©‚Äçüëß Pais</button>
    <button class="btn" onclick="abrirArea('presenca')">‚úÖ Presen√ßa</button>
    <button class="btn" onclick="abrirArea('oferta')">üí∞ Ofertas</button>
    <button class="btn" onclick="abrirArea('feed')">üì∞ Feed</button>
    <button class="btn" onclick="abrirArea('arquivos')">üìÅ Arquivos</button>
  </div>

  <!-- √Årea dos Pais (Fichas) -->
  <section id="area-pais" class="card hidden">
    <h2>Fichas cadastrais</h2>
    <input id="ficha-nome" placeholder="Nome da crian√ßa">
    <input id="ficha-nasc" type="date">
    <input id="ficha-resp" placeholder="Respons√°vel">
    <input id="ficha-tel" placeholder="Telefone">
    <textarea id="ficha-obs" placeholder="Observa√ß√µes / Alergias"></textarea>
    <button class="btn" onclick="salvarFicha()">Salvar ficha</button>
    <h3 class="mt-12">Fichas salvas</h3>
    <ul id="fichas-lista"></ul>
  </section>

  <!-- Presen√ßa -->
  <section id="area-presenca" class="card hidden">
    <h2>Lista de Presen√ßa</h2>
    <div class="flex mt-8">
      <label for="dia-chamada"><strong>Dia:</strong></label>
      <input id="dia-chamada" type="date" />
    </div>
    <div id="aluno-controles" class="flex mt-8">
      <input id="novo-nome" placeholder="Nome">
      <select id="novo-tipo">
        <option value="Aluno">Aluno</option>
        <option value="Convidado">Convidado</option>
      </select>
      <button class="btn" onclick="adicionarPresenca()">Adicionar presen√ßa</button>
    </div>
    <table class="mt-8">
      <thead>
        <tr>
          <th>NOME</th><th>DATA</th><th>PRESENTE</th><th>TIPO</th><th>REGISTRADO POR</th>
        </tr>
      </thead>
      <tbody id="lista-presenca"></tbody>
    </table>
  </section>

  <!-- Ofertas -->
  <section id="area-oferta" class="card hidden">
    <h2>Ofertas</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Registro</h3>
        <select id="of-cat">
          <option value="Oferta">Oferta</option>
          <option value="Gasto">Gasto</option>
        </select>
        <select id="of-tipo">
          <option value="Entrada">Entrada</option>
          <option value="Sa√≠da">Sa√≠da</option>
        </select>
        <input id="of-valor" type="number" min="0" step="0.01" placeholder="Valor">
        <input id="of-obs" placeholder="Observa√ß√£o (opcional)">
        <button class="btn" onclick="adicionarOferta()">Registrar</button>
      </div>
      <div style="flex:1 1 320px">
        <h3>Hist√≥rico</h3>
        <table>
          <thead>
            <tr><th>DATA</th><th>CATEGORIA</th><th>TIPO</th><th>VALOR</th><th>OBSERVA√á√ÉO</th><th>REGISTRADO POR</th></tr>
          </thead>
          <tbody id="historico-oferta"></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Feed -->
  <section id="area-feed" class="card hidden">
    <h2>Feed</h2>
    <textarea id="feed-texto" placeholder="Escreva uma mensagem..."></textarea>
    <label><input type="checkbox" id="feed-publico"> P√∫blico</label>
    <input id="feed-mencoes" placeholder="Mencionar (separe por v√≠rgula)">
    <select id="feed-tipo">
      <option value="aviso">Aviso</option>
      <option value="evento">Evento</option>
      <option value="escala">Escala</option>
    </select>
    <input id="feed-criado-por" placeholder="Seu nome">
    <button class="btn" onclick="postarFeed()">Postar</button>
    <h3 class="mt-12">Mensagens</h3>
    <ul id="feed-publico-lista"></ul>
  </section>

  <!-- Arquivos -->
  <section id="area-arquivos" class="card hidden">
    <h2>Arquivos</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Adicionar</h3>
        <input id="arq-titulo" placeholder="T√≠tulo">
        <select id="arq-tipo">
          <option value="pdf">PDF</option>
          <option value="txt">TXT</option>
          <option value="link">LINK</option>
        </select>
        <input id="arq-url" placeholder="URL (drive/link)">
        <button class="btn" onclick="enviarArquivo()">Salvar</button>
      </div>
      <div style="flex:1 1 320px">
        <h3>Lista</h3>
        <table>
          <thead>
            <tr><th>T√çTULO</th><th>TIPO</th><th>URL</th><th>CRIADO EM</th></tr>
          </thead>
          <tbody id="arquivos-lista"></tbody>
        </table>
      </div>
    </div>
  </section>
</main>

<script>
  // Config: substitua se mudar sua URL /exec
  const API_BASE = "https://script.google.com/macros/s/AKfycbzZjAf7796t3Xx30wxOeUjfbiIhqFyLHZ8aa1VwwgvTpS1sFbazYGnHvHk_AMKxhGsYzw/exec";

  // Navega√ß√£o
  function mostrarMenu(){ document.getElementById('menuPrincipal').classList.remove('hidden'); }
  function abrirArea(id){
    const ids=['pais','presenca','oferta','feed','arquivos'];
    ids.forEach(a=>document.getElementById('area-'+a).classList.add('hidden'));
    document.getElementById('area-'+id).classList.remove('hidden');
    if(id==='presenca'){ if(!document.getElementById('dia-chamada').value) document.getElementById('dia-chamada').value = new Date().toISOString().slice(0,10); carregarPresencas(); }
    if(id==='oferta'){ carregarOfertas(); }
    if(id==='feed'){ carregarFeed(); }
    if(id==='arquivos'){ carregarArquivos(); }
    if(id==='pais'){ carregarFichas(); }
  }

  // Presen√ßa ‚Äî colunas: NOME, DATA, PRESENTE, TIPO, REGISTRADO POR
  function adicionarPresenca(){
    const nome = document.getElementById('novo-nome').value.trim();
    const tipo = document.getElementById('novo-tipo').value;
    const data = document.getElementById('dia-chamada').value;
    const registradoPor = "Site";
    if(!nome || !data){ alert('Informe nome e data.'); return; }
    const dados = [nome, data, "Sim", tipo, registradoPor];
    fetch(`${API_BASE}?sheet=Presen√ßas`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Presen√ßa registrada!'); document.getElementById('novo-nome').value=''; carregarPresencas(); })
      .catch(err=>{ console.error(err); alert('Erro ao registrar.'); });
  }
  function carregarPresencas(){
    fetch(`${API_BASE}?sheet=Presen√ßas`)
      .then(res=>res.json())
      .then(data=>{
        const tbody = document.getElementById('lista-presenca');
        tbody.innerHTML = "";
        data.slice(1).forEach(linha=>{
          const tr = document.createElement('tr');
          linha.forEach(cel=>{
            const td = document.createElement('td');
            td.textContent = cel;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(err=>console.error(err));
  }

  // Fichas ‚Äî colunas: NOME, NASCIMENTO, RESPONS√ÅVEL, TELEFONE, OBSERVA√á√ÉO
  function salvarFicha(){
    const nome = document.getElementById('ficha-nome').value.trim();
    const nasc = document.getElementById('ficha-nasc').value;
    const resp = document.getElementById('ficha-resp').value.trim();
    const tel  = document.getElementById('ficha-tel').value.trim();
    const obs  = document.getElementById('ficha-obs').value.trim();
    if(!nome || !nasc || !resp){ alert('Preencha nome, nascimento e respons√°vel.'); return; }
    const dados = [nome, nasc, resp, tel, obs];
    fetch(`${API_BASE}?sheet=Fichas`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Ficha salva!'); document.getElementById('ficha-nome').value=''; document.getElementById('ficha-nasc').value=''; document.getElementById('ficha-resp').value=''; document.getElementById('ficha-tel').value=''; document.getElementById('ficha-obs').value=''; carregarFichas(); })
      .catch(err=>{ console.error(err); alert('Erro ao salvar ficha.'); });
  }
  function carregarFichas(){
    fetch(`${API_BASE}?sheet=Fichas`)
      .then(res=>res.json())
      .then(data=>{
        const lista = document.getElementById('fichas-lista');
        lista.innerHTML = "";
        data.slice(1).forEach(linha=>{
          const li = document.createElement('li');
          li.textContent = `${linha[0]} ‚Äî Resp: ${linha[2]} ‚Äî Tel: ${linha[3]}`;
          lista.appendChild(li);
        });
      })
      .catch(err=>console.error(err));
  }

  // Ofertas ‚Äî colunas: DATA, CATEGORIA, TIPO, VALOR, OBSERVA√á√ÉO, REGISTRADO POR
  function adicionarOferta(){
    const data = new Date().toISOString().slice(0,10);
    const categoria = document.getElementById('of-cat').value;
    const tipo = document.getElementById('of-tipo').value;
    const valor = document.getElementById('of-valor').value;
    const obs   = document.getElementById('of-obs').value.trim();
    const registradoPor = "Site";
    if(!valor){ alert('Informe o valor.'); return; }
    const dados = [data, categoria, tipo, valor, obs, registradoPor];
    fetch(`${API_BASE}?sheet=Ofertas`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Oferta registrada!'); document.getElementById('of-valor').value=''; document.getElementById('of-obs').value=''; carregarOfertas(); })
      .catch(err=>{ console.error(err); alert('Erro ao registrar oferta.'); });
  }
  function carregarOfertas(){
    fetch(`${API_BASE}?sheet=Ofertas`)
      .then(res=>res.json())
      .then(data=>{
        const tbody = document.getElementById('historico-oferta');
        tbody.innerHTML = "";
        data.slice(1).forEach(linha=>{
          const tr = document.createElement('tr');
          linha.forEach(cel=>{
            const td = document.createElement('td');
            td.textContent = cel;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(err=>console.error(err));
  }

  // Feed ‚Äî colunas: TEXTO, P√öBLICO, MENCIONADOS, TIPO, CRIADO POR, DATA
  function postarFeed(){
    const texto = document.getElementById('feed-texto').value.trim();
    const publico = document.getElementById('feed-publico').checked ? "Sim" : "N√£o";
    const mencoes = document.getElementById('feed-mencoes').value.trim();
    const tipo = document.getElementById('feed-tipo').value;
    const criadoPor = document.getElementById('feed-criado-por').value.trim() || "Site";
    const data = new Date().toISOString();
    if(!texto){ alert('Escreva uma mensagem.'); return; }
    const dados = [texto, publico, mencoes, tipo, criadoPor, data];
    fetch(`${API_BASE}?sheet=Feed`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Mensagem postada!'); document.getElementById('feed-texto').value=''; document.getElementById('feed-mencoes').value=''; carregarFeed(); })
      .catch(err=>{ console.error(err); alert('Erro ao postar.'); });
  }
  function carregarFeed(){
    fetch(`${API_BASE}?sheet=Feed`)
      .then(res=>res.json())
      .then(data=>{
        const lista = document.getElementById('feed-publico-lista');
        lista.innerHTML = "";
        data.slice(1).forEach(linha=>{
          const li = document.createElement('li');
          li.textContent = `[${linha[5]}] (${linha[3]}) ${linha[0]} ‚Äî P√∫blico: ${linha[1]} ‚Äî Por: ${linha[4]}`;
          lista.appendChild(li);
        });
      })
      .catch(err=>console.error(err));
  }

  // Arquivos ‚Äî colunas: T√çTULO, TIPO, URL, CRIADO EM
  function enviarArquivo(){
    const titulo = document.getElementById('arq-titulo').value.trim();
    const tipo   = document.getElementById('arq-tipo').value;
    const url    = document.getElementById('arq-url').value.trim();
    const criadoEm = new Date().toISOString();
    if(!titulo || !url){ alert('Informe t√≠tulo e URL.'); return; }
    const dados = [titulo, tipo, url, criadoEm];
    fetch(`${API_BASE}?sheet=Arquivos`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Arquivo registrado!'); document.getElementById('arq-titulo').value=''; document.getElementById('arq-url').value=''; carregarArquivos(); })
      .catch(err=>{ console.error(err); alert('Erro ao registrar arquivo.'); });
  }
  function carregarArquivos(){
    fetch(`${API_BASE}?sheet=Arquivos`)
      .then(res=>res.json())
      .then(data=>{
        const tbody = document.getElementById('arquivos-lista');
        tbody.innerHTML = "";
        data.slice(1).forEach(linha=>{
          const tr = document.createElement('tr');
          // T√çTULO, TIPO, URL, CRIADO EM
          linha.forEach((cel, idx)=>{
            const td = document.createElement('td');
            if(idx===2){
              const a = document.createElement('a');
              a.href = cel; a.target = "_blank"; a.textContent = cel || 'link';
              td.appendChild(a);
            } else {
              td.textContent = cel;
            }
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(err=>console.error(err));
  }

  // Inicial
  window.addEventListener('load', ()=> mostrarMenu());
</script>

</body>
</html>
