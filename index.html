<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>MCI Kids - Minist√©rio Infantil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primaria:#4B1E6D; --secundaria:#FF9800; --azul:#4FC3F7; --verde:#8BC34A;
      --fundo:#FFF8E1; --card:#FCE4EC; --texto:#333; --borda:#ddd;
    }
    *{box-sizing:border-box}
    body {
      font-family:'Comic Neue',cursive;
      margin:0;
      color:var(--texto);
      font-size:17px;
      background: linear-gradient(135deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 1400% 1400%;
      animation: rainbow 20s ease infinite;
    }
    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header{background:var(--primaria);color:#fff;padding:16px;text-align:center}
    header img{height:90px}
    main{max-width:1000px;margin:0 auto;padding:16px}
    .versiculo{font-style:italic;color:#000;text-align:center;margin:12px 0 20px}
    .menu-grid{display:grid;gap:12px;grid-template-columns:1fr;margin-top:12px}
    @media(min-width:640px){.menu-grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:900px){.menu-grid{grid-template-columns:repeat(4,1fr)}}
    .btn{background:var(--secundaria);color:#fff;border:none;padding:12px 16px;border-radius:8px;cursor:pointer;font-size:16px}
    .btn:hover{background:#F57C00}
    .btn-sec{background:var(--azul)}
    .btn-danger{background:#e53935}
    .btn-ghost{background:transparent;color:var(--primaria);border:1px solid var(--primaria)}
    .card{background:var(--card);border-radius:12px;padding:16px;margin-top:16px;border:1px solid var(--borda)}
    .hidden{display:none!important}
    input,select,textarea{width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:8px;font-size:16px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #bbb;padding:8px;text-align:center;font-size:15px}
    th{background:#f5f5f5}
    .pill{display:inline-block;padding:4px 8px;border-radius:999px;background:#eee;font-size:12px}
    .subtle{color:#666;font-size:13px}
    .center{text-align:center}
    .mt-8{margin-top:8px} .mt-12{margin-top:12px} .mt-16{margin-top:16px}
    .flex{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label strong{margin-right:8px}
  </style>
</head>
<body>
<header>
  <img src="logo.png" alt="Logo MCI Kids">
  <h1>Minist√©rio Infantil - MCI Kids</h1>
</header>
<main>
  <p class="versiculo">"Ensina a crian√ßa no caminho em que deve andar..." - Prov√©rbios 22:6</p>
  <div class="center"><button class="btn" onclick="mostrarMenu()">Entrar</button></div>

  <!-- Menu principal -->
  <div id="menuPrincipal" class="menu-grid hidden">
    <button class="btn" onclick="abrirArea('pais')">üë®‚Äçüë©‚Äçüëß Pais</button>
    <button class="btn" onclick="abrirArea('lider')">üôã‚Äç‚ôÇÔ∏è L√≠der</button>
    <button class="btn" onclick="abrirArea('auxiliar')">üßë‚Äçüè´ Auxiliar</button>
    <button class="btn" onclick="abrirArea('oferta')">üí∞ Oferta</button>
    <button class="btn btn-sec" onclick="abrirArea('feed')">üì∞ Feed</button>
  </div>
  <!-- √Årea dos Pais -->
  <section id="area-pais" class="card hidden">
    <h2>√Årea dos Pais</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Temas do m√™s</h3>
        <ul id="temasPais"></ul>
        <h3>Eventos</h3>
        <ul id="eventosPais"></ul>
      </div>
      <div style="flex:1 1 320px">
        <h3>Ficha cadastral</h3>
        <input id="ficha-nome" placeholder="Nome da crian√ßa">
        <input id="ficha-nasc" type="date">
        <input id="ficha-resp" placeholder="Nome do respons√°vel">
        <input id="ficha-tel" placeholder="Telefone">
        <textarea id="ficha-obs" placeholder="Alergias/Observa√ß√µes"></textarea>
        <button class="btn" onclick="salvarFicha()">Salvar ficha</button>
        <ul id="fichas-lista" class="mt-12"></ul>
      </div>
    </div>
    <p class="subtle">Ficha manual; depois podemos gerar PDF ou salvar na nuvem.</p>
  </section>

  <!-- √Årea do L√≠der -->
  <section id="area-lider" class="card hidden">
    <h2>L√≠der</h2>
    <div id="lider-login">
      <input id="lider-email" type="email" placeholder="Email">
      <input id="lider-senha" type="password" placeholder="Senha">
      <button class="btn" onclick="login('lider')">Entrar</button>
      <p id="lider-erro" class="subtle"></p>
    </div>
    <div id="lider-painel" class="hidden">
      <p><span class="pill">L√≠der</span> Acesso completo.</p>
      <div class="flex">
        <button class="btn" onclick="abrirArea('presenca')">‚úÖ Presen√ßa</button>
        <button class="btn" onclick="abrirArea('arquivos')">üìÅ Arquivos</button>
        <button class="btn btn-sec" onclick="abrirArea('feed')">üì∞ Feed</button>
        <button class="btn" onclick="abrirArea('oferta')">üí∞ Oferta</button>
      </div>
      <div id="lider-fichas" class="mt-16">
        <h3>Fichas recebidas dos Pais</h3>
        <ul id="fichas-lider"></ul>
      </div>
    </div>
  </section>

  <!-- √Årea do Auxiliar -->
  <section id="area-auxiliar" class="card hidden">
    <h2>Auxiliar</h2>
    <div id="auxiliar-entrada">
      <input id="aux-nome" placeholder="Seu nome">
      <button class="btn" onclick="entrarAuxiliar()">Entrar</button>
      <p id="aux-erro" class="subtle"></p>
    </div>
    <div id="auxiliar-painel" class="hidden">
      <p><span class="pill">Auxiliar</span> Permiss√µes limitadas.</p>
      <div class="flex">
        <button class="btn" onclick="abrirArea('presenca')">‚úÖ Presen√ßa</button>
        <button class="btn" onclick="abrirArea('arquivos')">üìÅ Arquivos</button>
        <button class="btn btn-sec" onclick="abrirArea('feed')">üì∞ Feed</button>
        <button class="btn" onclick="abrirArea('oferta')">üí∞ Oferta</button>
        <button class="btn btn-danger" onclick="sairAuxiliar()">Sair</button>
      </div>
    </div>
  </section>
  <!-- Presen√ßa -->
  <section id="area-presenca" class="card hidden">
    <h2>Lista de Presen√ßa</h2>

    <!-- Data da chamada -->
    <div class="flex mt-8">
      <label for="dia-chamada"><strong>Dia da chamada:</strong></label>
      <input id="dia-chamada" type="date" />
      <button class="btn" onclick="renderPresenca()">Atualizar lista</button>
    </div>

    <!-- Controles de cadastro de pessoas -->
    <div id="aluno-controles" class="flex mt-8">
      <input id="novo-nome" placeholder="Nome do aluno/convidado">
      <select id="novo-tipo">
        <option value="aluno">Aluno</option>
        <option value="convidado">Convidado</option>
      </select>
      <button class="btn" onclick="adicionarPessoa()">Adicionar</button>
    </div>

    <!-- Tabela planilha -->
    <table class="mt-8">
      <thead>
        <tr>
          <th>Nome</th><th>Dia</th><th>Presen√ßa</th><th>Tipo</th><th>Registrado por</th><th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="lista-presenca"></tbody>
    </table>

    <!-- Resumo e exporta√ß√£o -->
    <div class="mt-12">
      <h3>Resumo</h3>
      <div id="filtros-presenca" class="flex">
        <div class="intervalo-pres">
          <label>In√≠cio</label><input type="date" class="pres-inicio">
          <label>Fim</label><input type="date" class="pres-fim">
        </div>
      </div>
      <div class="flex mt-8">
        <button class="btn" onclick="adicionarIntervalo('presenca')">Adicionar intervalo</button>
        <button class="btn btn-sec" onclick="exportarPresencas()">Exportar CSV</button>
      </div>
      <table>
        <thead>
          <tr><th>Nome</th><th>% Frequ√™ncia</th><th>Presentes</th><th>Faltas</th></tr>
        </thead>
        <tbody id="resumo-presenca"></tbody>
      </table>
    </div>
    <p class="subtle mt-8">Auxiliar edita/deleta dentro de 24h; l√≠der sempre.</p>
  </section>

  <!-- Arquivos -->
  <section id="area-arquivos" class="card hidden">
    <h2>Arquivos</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Enviar arquivo</h3>
        <input id="arq-titulo" placeholder="T√≠tulo">
        <select id="arq-tipo">
          <option value="pdf">PDF</option>
          <option value="txt">TXT</option>
        </select>
        <input id="arq-file" type="file" accept=".pdf,.txt">
        <div class="mt-8"><button class="btn" onclick="enviarArquivo()">Enviar</button></div>
        <p class="subtle mt-8">Links reais vir√£o do Storage quando conectarmos a nuvem.</p>
      </div>
      <div style="flex:1 1 320px">
        <h3>Lista</h3>
        <ul id="arquivos-lista"></ul>
      </div>
    </div>
  </section>
  <!-- Ofertas -->
  <section id="area-oferta" class="card hidden">
    <h2>Ofertas</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Adicionar valor</h3>
        <select id="of-cat">
          <option value="oferta">Oferta</option>
          <option value="gasto">Gasto pessoal</option>
        </select>
        <select id="of-tipo">
          <option value="entrada">Entrada</option>
          <option value="saida">Sa√≠da</option>
        </select>
        <input id="of-valor" type="number" min="0" step="0.01" placeholder="Valor">
        <input id="of-obs" placeholder="Observa√ß√£o (opcional)">
        <button class="btn" onclick="adicionarOferta()">Registrar</button>
        <p class="subtle">Auxiliar n√£o registra sa√≠da de oferta.</p>
      </div>
      <div style="flex:1 1 320px">
        <h3>Saldo atual (Oferta)</h3>
        <p><strong id="saldo-atual">R$ 0,00</strong></p>
        <p class="subtle">Saldo = entradas de oferta ‚àí sa√≠das de oferta.</p>
      </div>
    </div>
    <h3 class="mt-12">Hist√≥rico</h3>
    <table>
      <thead>
        <tr><th>Data</th><th>Categoria</th><th>Tipo</th><th>Valor</th><th>Registrado por</th><th>Obs</th><th>A√ß√µes</th></tr>
      </thead>
      <tbody id="historico-oferta"></tbody>
    </table>
    <div class="mt-12">
      <h3>Exportar</h3>
      <div id="filtros-oferta" class="flex">
        <div class="intervalo-of">
          <label>In√≠cio</label><input type="date" class="of-inicio">
          <label>Fim</label><input type="date" class="of-fim">
        </div>
      </div>
      <div class="flex mt-8">
        <button class="btn" onclick="adicionarIntervalo('oferta')">Adicionar intervalo</button>
        <button class="btn btn-sec" onclick="exportarOfertas()">Exportar CSV</button>
      </div>
    </div>
  </section>

  <!-- Feed -->
  <section id="area-feed" class="card hidden">
    <h2>Feed</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Nova mensagem</h3>
        <textarea id="feed-texto" placeholder="Escreva uma mensagem..."></textarea>
        <label><input type="checkbox" id="feed-publico"> Tornar p√∫blico (eventos/avisos)</label>
        <input id="feed-mencoes" placeholder="Mencionar usu√°rios (separe por v√≠rgula)">
        <select id="feed-tipo">
          <option value="aviso">Aviso</option>
          <option value="evento">Evento</option>
          <option value="escala">Escala</option>
        </select>
        <button class="btn" onclick="postarFeed()">Postar</button>
        <p class="subtle">Privado: s√≥ mencionados veem. L√≠der v√™ tudo.</p>
      </div>
      <div style="flex:1 1 320px">
        <h3>Feed do seu papel</h3>
        <ul id="feed-papel"></ul>
      </div>
      <div style="flex:1 1 320px">
        <h3>Feed p√∫blico</h3>
        <ul id="feed-publico-lista"></ul>
      </div>
    </div>
  </section>
</main>
<script>
  // ===========================
  // ESTADO GLOBAL
  // ===========================
  const estado = {
    usuario: null,             // { uid, nome, papel }
    papel: 'visitante',
    auxiliarNome: '',
    alunos: [],                // [{id,nome,tipo}]
    presencas: [],             // [{id,alunoId,dataISO,presente,registradoPorNome,papel,criadoEm}]
    ofertas: [],               // [{id,categoria,tipo,valor,obs,criadoEm,registradoPorNome,papel}]
    feed: [],                  // [{id,texto,publico,mencionados[],tipo,criadoEm,criadoPorNome,reacoes,comentarios[]}]
    arquivos: [],              // [{id,titulo,tipo,url,criadoEm}]
    fichas: []                 // [{id,nome,nasc,resp,tel,obs,criadoEm}]
  };

  // ===========================
  // NAVEGA√á√ÉO
  // ===========================
  function mostrarMenu(){ document.getElementById('menuPrincipal').classList.remove('hidden'); }
  function abrirArea(id){
    const ids=['pais','lider','auxiliar','oferta','feed','arquivos','presenca'];
    ids.forEach(a=>document.getElementById('area-'+a).classList.add('hidden'));
    document.getElementById('area-'+id).classList.remove('hidden');
    if(id==='presenca') {
      const inputDia = document.getElementById('dia-chamada');
      if (inputDia && !inputDia.value) inputDia.value = new Date().toISOString().slice(0,10);
      renderPresenca();
    }
    if(id==='oferta') renderOferta();
    if(id==='feed') renderFeed();
    if(id==='arquivos') renderArquivos();
    if(id==='pais') renderPais();
    if(id==='lider') renderFichasLider();
  }
  function setPapel(p){
    estado.papel=p;
    if(p==='lider'){
      document.getElementById('lider-login').classList.add('hidden');
      document.getElementById('lider-painel').classList.remove('hidden');
    } else if(p==='auxiliar'){
      document.getElementById('auxiliar-entrada').classList.add('hidden');
      document.getElementById('auxiliar-painel').classList.remove('hidden');
    }
  }

  // ===========================
  // LOGIN / AUXILIAR
  // ===========================
  async function login(papel){
    const email=document.getElementById(`${papel}-email`)?.value;
    const senha=document.getElementById(`${papel}-senha`)?.value;
    if(!email||!senha){ document.getElementById(`${papel}-erro`).textContent='Digite email e senha.'; return; }
    estado.usuario={ uid:'uid-'+papel, nome:'L√≠der', papel };
    setPapel(papel);
    alert('L√≠der logado com sucesso!');
  }
  function entrarAuxiliar(){
    const nomeInput=document.getElementById('aux-nome');
    const nome=(nomeInput.value||'').trim();
    if(!nome){ document.getElementById('aux-erro').textContent='Informe seu nome.'; nomeInput.focus(); return; }
    estado.usuario={ uid:'aux-'+Date.now(), nome, papel:'auxiliar' };
    estado.auxiliarNome=nome;
    setPapel('auxiliar');
    alert(`Auxiliar ${nome} entrou.`);
  }
  function sairAuxiliar(){
    estado.usuario=null; estado.papel='visitante'; estado.auxiliarNome='';
    document.getElementById('auxiliar-painel').classList.add('hidden');
    document.getElementById('auxiliar-entrada').classList.remove('hidden');
    alert('Voc√™ saiu como auxiliar.');
  }

  // ===========================
  // (continua com todas as fun√ß√µes de regras de edi√ß√£o, presen√ßa, ofertas, feed e arquivos exatamente como no seu arquivo original)
  // ===========================
</script>
</body>
</html>

