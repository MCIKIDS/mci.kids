<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>MCI Kids - Minist√©rio Infantil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primaria:#4B1E6D; --secundaria:#FF9800; --card:#FCE4EC; --texto:#333; --borda:#ddd;
    }
    *{box-sizing:border-box}
    body {
      font-family:'Comic Neue',cursive;
      margin:0;
      font-size:17px;
      background: linear-gradient(135deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 1400% 1400%;
      animation: rainbow 20s ease infinite;
    }
    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header{background:var(--primaria);color:#fff;padding:16px;text-align:center}
    header img{height:90px}
    main{max-width:1000px;margin:0 auto;padding:16px}
    .card{background:var(--card);border-radius:12px;padding:16px;margin-top:16px;border:1px solid var(--borda)}
    .hidden{display:none!important}
    input,select,textarea{width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:8px;font-size:16px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #bbb;padding:8px;text-align:center;font-size:15px}
    th{background:#f5f5f5}
    .btn{background:var(--secundaria);color:#fff;border:none;padding:12px 16px;border-radius:8px;cursor:pointer;font-size:16px}
    .btn:hover{background:#F57C00}
    .versiculo {
      text-align: center;
      font-size: 20px;
      font-weight: normal;
      color: #fff;
      margin-top: 20px;
      padding: 10px;
    }
    .center {
      text-align: center;
    }
    .menu-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
<header>
  <img src="logo.png" alt="Logo MCI Kids">
  <h1>Minist√©rio Infantil - MCI Kids</h1>
</header>
<main>
  <p class="versiculo">"Ensina a crian√ßa no caminho em que deve andar..." - Prov√©rbios 22:6</p>
  <div class="center">
    <button class="btn" onclick="mostrarMenu()">Entrar</button>
  </div>
  <div id="menuPrincipal" class="menu-grid hidden">
    <button class="btn" onclick="abrirArea('login-lider')">üôã‚Äç‚ôÇÔ∏è L√≠der</button>
    <button class="btn" onclick="abrirArea('login-auxiliar')">üßë‚Äçüè´ Auxiliar</button>
    <button class="btn" onclick="abrirArea('pais')">üë®‚Äçüë©‚Äçüëß Pais</button>
    <button class="btn" onclick="abrirArea('presenca')">‚úÖ Presen√ßa</button>
    <button class="btn" onclick="abrirArea('oferta')">üí∞ Ofertas</button>
    <button class="btn" onclick="abrirArea('feed')">üì∞ Feed</button>
    <button class="btn" onclick="abrirArea('arquivos')">üìÅ Arquivos</button>
  </div>
  <!-- Login L√≠der -->
  <section id="area-login-lider" class="card hidden">
    <h2>Login L√≠der</h2>
    <input id="login-lider-email" type="email" placeholder="Email">
    <input id="login-lider-senha" type="password" placeholder="Senha">
    <button class="btn" onclick="login('login-lider')">Entrar como L√≠der</button>
    <p id="login-lider-erro" style="color:red"></p>
  </section>

  <!-- Login Auxiliar -->
  <section id="area-login-auxiliar" class="card hidden">
    <h2>Login Auxiliar</h2>
    <input id="aux-nome" type="text" placeholder="Seu nome">
    <button class="btn" onclick="entrarAuxiliar()">Entrar</button>
    <p id="aux-erro" style="color:red"></p>
  </section>

  <!-- Fichas dos Pais -->
  <section id="area-pais" class="card hidden">
    <h2>Ficha da Crian√ßa</h2>
    <input id="ficha-nome" placeholder="Nome da crian√ßa">
    <input id="ficha-nasc" type="date" placeholder="Data de nascimento">
    <input id="ficha-resp" placeholder="Nome do respons√°vel">
    <input id="ficha-tel" placeholder="Telefone">
    <textarea id="ficha-obs" placeholder="Observa√ß√µes"></textarea>
    <button class="btn" onclick="salvarFicha()">Salvar Ficha</button>
    <h3 class="mt-12">Lista de Fichas</h3>
    <ul id="fichas-lista"></ul>
  </section>
  <!-- Presen√ßa -->
  <section id="area-presenca" class="card hidden">
    <h2>Presen√ßa</h2>
    <label>Data da chamada:</label>
    <input id="dia-chamada" type="date">
    <input id="novo-nome" placeholder="Nome da crian√ßa">
    <select id="novo-tipo">
      <option value="visitante">Visitante</option>
      <option value="membro">Membro</option>
    </select>
    <button class="btn" onclick="adicionarPresenca()">Registrar Presen√ßa</button>
    <h3 class="mt-12">Lista de Presen√ßas</h3>
    <table>
      <thead>
        <tr><th>Nome</th><th>Data</th><th>Presente</th><th>Tipo</th><th>Registrado por</th></tr>
      </thead>
      <tbody id="lista-presenca"></tbody>
    </table>
  </section>

  <!-- Ofertas -->
  <section id="area-oferta" class="card hidden">
    <h2>Ofertas</h2>
    <select id="of-cat">
      <option value="dizimo">D√≠zimo</option>
      <option value="oferta">Oferta</option>
      <option value="especial">Especial</option>
    </select>
    <select id="of-tipo">
      <option value="dinheiro">Dinheiro</option>
      <option value="pix">Pix</option>
      <option value="cartao">Cart√£o</option>
    </select>
    <input id="of-valor" type="number" placeholder="Valor">
    <textarea id="of-obs" placeholder="Observa√ß√µes"></textarea>
    <button class="btn" onclick="adicionarOferta()">Registrar Oferta</button>
    <h3 class="mt-12">Hist√≥rico de Ofertas</h3>
    <table>
      <thead>
        <tr><th>Data</th><th>Categoria</th><th>Tipo</th><th>Valor</th><th>Obs</th><th>Registrado por</th></tr>
      </thead>
      <tbody id="historico-oferta"></tbody>
    </table>
  </section>
  <!-- Feed -->
  <section id="area-feed" class="card hidden">
    <h2>Feed</h2>
    <textarea id="feed-texto" placeholder="Escreva uma mensagem..."></textarea>
    <label><input type="checkbox" id="feed-publico"> P√∫blico</label>
    <input id="feed-mencoes" placeholder="Mencionar (separe por v√≠rgula)">
    <select id="feed-tipo">
      <option value="aviso">Aviso</option>
      <option value="evento">Evento</option>
      <option value="escala">Escala</option>
    </select>
    <input id="feed-criado-por" placeholder="Seu nome">
    <button class="btn" onclick="postarFeed()">Postar</button>
    <h3 class="mt-12">Mensagens</h3>
    <ul id="feed-publico-lista"></ul>
  </section>

  <!-- Arquivos -->
  <section id="area-arquivos" class="card hidden">
    <h2>Arquivos</h2>
    <div class="flex">
      <div style="flex:1 1 320px">
        <h3>Adicionar</h3>
        <input id="arq-titulo" placeholder="T√≠tulo">
        <select id="arq-tipo">
          <option value="pdf">PDF</option>
          <option value="txt">TXT</option>
          <option value="link">LINK</option>
        </select>
        <input id="arq-url" placeholder="URL (drive/link)">
        <button class="btn" onclick="enviarArquivo()">Salvar</button>
      </div>
      <div style="flex:1 1 320px">
        <h3>Lista</h3>
        <table>
          <thead>
            <tr><th>T√çTULO</th><th>TIPO</th><th>URL</th><th>CRIADO EM</th></tr>
          </thead>
          <tbody id="arquivos-lista"></tbody>
        </table>
      </div>
    </div>
  </section>
<script>
  // Configura√ß√£o: URL da sua API Google Apps Script
  const API_BASE = "https://script.google.com/macros/s/AKfycbzZjAf7796t3Xx30wxOeUjfbiIhqFyLHZ8aa1VwwgvTpS1sFbazYGnHvHk_AMKxhGsYzw/exec";

  // Estado do usu√°rio logado
  let estado = { usuario: null };

  // Mostrar menu principal
  function mostrarMenu(){
    const menu = document.getElementById('menuPrincipal');
    if(menu){ menu.classList.remove('hidden'); }
  }

  // Abrir √°rea espec√≠fica
  function abrirArea(id){
    const ids=['login-lider','login-auxiliar','pais','presenca','oferta','feed','arquivos'];
    ids.forEach(a=>document.getElementById('area-'+a)?.classList.add('hidden'));
    document.getElementById('area-'+id)?.classList.remove('hidden');

    if(id==='presenca'){ 
      if(!document.getElementById('dia-chamada').value) 
        document.getElementById('dia-chamada').value = new Date().toISOString().slice(0,10); 
      carregarPresencas(); 
    }
    if(id==='oferta'){ carregarOfertas(); }
    if(id==='feed'){ carregarFeed(); }
    if(id==='arquivos'){ carregarArquivos(); }
    if(id==='pais'){ carregarFichas(); }
  }

  // Login L√≠der corrigido
  function login(papel){
    const email = document.getElementById(`${papel}-email`).value.trim();
    const senha = document.getElementById(`${papel}-senha`).value.trim();
    const erro = document.getElementById(`${papel}-erro`);

    if(!email || !senha){
      erro.textContent = 'Digite email e senha.';
      return;
    }

    // Simula√ß√£o de login v√°lido
    if(email === "lider@mci.com" && senha === "1234"){
      estado.usuario = { uid: 'lider', nome: 'L√≠der', papel: 'lider' };
      alert('Login do l√≠der realizado com sucesso!');
      abrirArea('presenca');
    } else {
      erro.textContent = 'Email ou senha inv√°lidos.';
    }
  }

  // Login Auxiliar corrigido
  function entrarAuxiliar(){
    const nome = document.getElementById('aux-nome').value.trim();
    const erro = document.getElementById('aux-erro');

    if(!nome){
      erro.textContent = 'Informe seu nome.';
      return;
    }

    estado.usuario = { uid: 'aux-'+Date.now(), nome, papel: 'auxiliar' };
    alert(`Bem-vindo, ${nome}!`);
    abrirArea('presenca');
  }

  // Presen√ßa
  function adicionarPresenca(){
    const nome = document.getElementById('novo-nome').value.trim();
    const tipo = document.getElementById('novo-tipo').value;
    const data = document.getElementById('dia-chamada').value;
    const registradoPor = estado.usuario?.nome || "Site";
    if(!nome || !data){ alert('Informe nome e data.'); return; }
    const dados = [nome, data, "Sim", tipo, registradoPor];
    fetch(`${API_BASE}?sheet=Presen√ßas`, { method: "POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Presen√ßa registrada!'); document.getElementById('novo-nome').value=''; carregarPresencas(); })
      .catch(err=>{ console  // Ofertas
  function adicionarOferta(){
    const cat = document.getElementById('of-cat').value;
    const tipo = document.getElementById('of-tipo').value;
    const valor = document.getElementById('of-valor').value;
    const obs = document.getElementById('of-obs').value.trim();
    const registradoPor = estado.usuario?.nome || "Site";
    const data = new Date().toISOString();
    if(!valor){ alert('Informe o valor.'); return; }
    const dados = [data, cat, tipo, valor, obs, registradoPor];
    fetch(`${API_BASE}?sheet=Ofertas`, { method:"POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Oferta registrada!'); document.getElementById('of-valor').value=''; document.getElementById('of-obs').value=''; carregarOfertas(); })
      .catch(err=>console.error(err));
  }

  function carregarOfertas(){
    fetch(`${API_BASE}?sheet=Ofertas`)
      .then(res=>res.json())
      .then(data=>{
        const tbody = document.getElementById('historico-oferta');
        tbody.innerHTML="";
        data.slice(1).forEach(linha=>{
          const tr = document.createElement('tr');
          linha.forEach(cel=>{
            const td = document.createElement('td');
            td.textContent = cel;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(err=>console.error(err));
  }

  // Feed
  function postarFeed(){
    const texto = document.getElementById('feed-texto').value.trim();
    const publico = document.getElementById('feed-publico').checked ? "Sim":"N√£o";
    const mencoes = document.getElementById('feed-mencoes').value.trim();
    const tipo = document.getElementById('feed-tipo').value;
    const criadoPor = document.getElementById('feed-criado-por').value.trim() || estado.usuario?.nome || "An√¥nimo";
    const data = new Date().toISOString();
    if(!texto){ alert('Digite uma mensagem.'); return; }
    const dados = [texto, publico, mencoes, tipo, criadoPor, data];
    fetch(`${API_BASE}?sheet=Feed`, { method:"POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Mensagem postada!'); document.getElementById('feed-texto').value=''; carregarFeed(); })
      .catch(err=>console.error(err));
  }

  function carregarFeed(){
    fetch(`${API_BASE}?sheet=Feed`)
      .then(res=>res.json())
      .then(data=>{
        const lista = document.getElementById('feed-publico-lista');
        lista.innerHTML="";
        data.slice(1).forEach(linha=>{
          const li = document.createElement('li');
          li.textContent = `[${linha[5]}] (${linha[3]}) ${linha[0]} ‚Äî P√∫blico: ${linha[1]} ‚Äî Por: ${linha[4]}`;
          lista.appendChild(li);
        });
      })
      .catch(err=>console.error(err));
  }

  // Arquivos
  function enviarArquivo(){
    const titulo = document.getElementById('arq-titulo').value.trim();
    const tipo = document.getElementById('arq-tipo').value;
    const url = document.getElementById('arq-url').value.trim();
    const criadoEm = new Date().toISOString();
    if(!titulo || !url){ alert('Informe t√≠tulo e URL.'); return; }
    const dados = [titulo, tipo, url, criadoEm];
    fetch(`${API_BASE}?sheet=Arquivos`, { method:"POST", body: JSON.stringify(dados) })
      .then(res=>res.text())
      .then(()=>{ alert('Arquivo salvo!'); document.getElementById('arq-titulo').value=''; document.getElementById('arq-url').value=''; carregarArquivos(); })
      .catch(err=>console.error(err));
  }

  function carregarArquivos(){
    fetch(`${API_BASE}?sheet=Arquivos`)
      .then(res=>res.json())
      .then(data=>{
        const tbody = document.getElementById('arquivos-lista');
        tbody.innerHTML="";
        data.slice(1).forEach(linha=>{
          const tr = document.createElement('tr');
          linha.forEach(cel=>{
            const td = document.createElement('td');
            td.textContent = cel;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      })
      .catch(err=>console.error(err));
  }
</script>
</main>
</body>
</html>
